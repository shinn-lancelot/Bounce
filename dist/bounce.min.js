!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Bounce=e()}(this,function(){"use strict";var t={el:"",container:"body",effect:1,direction:1,effectConfig:{maxAngle:30,moveSpeed:40},perspective:800,transitionDuration:.1,keep:!0};class e{static extend(t,e){for(let o in e)if(o in t){if(t[o].constructor===e[o].constructor)if(t[o].constructor===Object){let i=t[o],s=e[o];for(let t in s)i[t]=s[t];t[o]=i}else t[o]=e[o]}else t[o]=e[o];return t}}return class{constructor(t={}){this.init(t),this.checkOptions()&&(this.calCenterPosition(),this.listenMouseMove(),this.listenMouseLeave())}init(o){this.options=e.extend(JSON.parse(JSON.stringify(t)),o),this.elObjs=document.querySelectorAll(this.options.el),this.containerObj=document.querySelector(this.options.container),this.containerObj.style.transformStyle="preserve-3d",this.containerObj.style.perspective=`${this.options.perspective}px`,this.elObjs.forEach(t=>{t.style.transitionProperty="transform",t.style.transitionDuration=`${this.options.transitionDuration}s`,t.style.transformStyle="preserve-3d"})}checkOptions(){return this.options.el?"string"==typeof this.options.el||(console.error("el参数必须是字符串"),!1):(console.error("缺少el参数"),!1)}calCenterPosition(){this.centerPosition=this.getCenterPostion(this.containerObj)}listenMouseMove(){this.containerObj.addEventListener("mousemove",this.handleMouseMove.bind(this),!1)}listenMouseLeave(){this.containerObj.addEventListener("mouseleave",this.handleMouseLeave.bind(this),!1)}handleMouseMove(t){window.requestAnimationFrame(()=>{let e=this.getPosition(t),o=this.calcDeltaPostion(e,this.centerPosition),i=this.calOffsetPercent(e,this.centerPosition);this.elObjs.forEach(t=>{this.effect(t,i,o)})})}handleMouseLeave(){this.options.keep||setTimeout(()=>{this.elObjs.forEach(t=>{1===this.options.effect?t.style.transform="rotateX(0) rotateY(0)":2===this.options.effect?t.style.transform="translateX(0) translateY(0)":3===this.options.effect&&(t.style.transform="rotateX(0) rotateY(0) translateX(0) translateY(0)")})},1e3*this.options.transitionDuration)}getPosition(t){let e=t||window.event;return{x:e.clientX,y:e.clientY}}getCenterPostion(t){return{x:t.offsetWidth/2,y:t.offsetHeight/2}}calcDeltaPostion(t,e){return{x:t.x-e.x,y:t.y-e.y}}calOffsetPercent(t,e){return{xPercent:(t.x-e.x)/e.x,yPercent:(t.y-e.y)/e.y}}effect(t,e,o){let i=-1*(e.yPercent*this.options.effectConfig.maxAngle).toFixed(0)*this.options.direction,s=(e.xPercent*this.options.effectConfig.maxAngle).toFixed(0)*this.options.direction,n=e.xPercent*this.options.effectConfig.moveSpeed*this.options.direction,r=e.yPercent*this.options.effectConfig.moveSpeed*this.options.direction;1===this.options.effect?t.style.transform=`rotateX(${i}deg) rotateY(${s}deg)`:2===this.options.effect?t.style.transform=`translateX(${n}px) translateY(${r}px)`:3===this.options.effect&&(t.style.transform=`rotateX(${i}deg) rotateY(${s}deg) translateX(${n}px) translateY(${r}px)`)}}});
